# 配置选项

## 📖 概述

本文档详细介绍GitHub中文翻译插件(GitHub_i18n)的配置选项，帮助高级用户根据自己的需求调整插件行为和性能参数。

## ⚙️ 配置文件位置

配置参数主要位于插件源代码的`CONFIG`对象中。您可以通过修改用户脚本的源代码来调整这些配置。

## 📝 核心配置选项

## 更新与版本检查

```javascript

const CONFIG = {
  // 是否启用自动更新检查
  updateCheck: true,
  // 版本检查的间隔时间（毫秒）
  versionCheckInterval: 24 * 60 * 60 * 1000, // 默认24小时
  // 是否在发现新版本时自动更新
  autoUpdate: false,
};

```

* *说明：**
- `updateCheck`: 控制是否启用版本检查功能
- `versionCheckInterval`: 设置检查更新的时间间隔，默认为24小时
- `autoUpdate`: 是否自动安装新版本，默认关闭（需用户确认）

## 翻译行为

```javascript

const CONFIG = {
  // 是否启用翻译
  enableTranslation: true,
  // 是否翻译代码内容
  translateCode: false,
  // 是否翻译链接文本
  translateLinks: true,
  // 翻译后是否保留原始英文（用于对照学习）
  showOriginalText: false,
};

```

* *说明：**
- `enableTranslation`: 全局开关，控制是否启用翻译功能
- `translateCode`: 是否翻译代码块中的文本（默认不翻译）
- `translateLinks`: 是否翻译链接文本
- `showOriginalText`: 是否在翻译后保留原始英文文本

## 性能优化参数

```javascript

const CONFIG = {
  // 防抖延迟时间（毫秒）
  debounceDelay: 200,
  // 节流时间（毫秒）
  throttleTime: 1000,
  // 是否启用翻译缓存
  enableCache: true,
  // 缓存大小限制
  cacheSizeLimit: 5000,
  // DOM变化监听选项
  mutationObserverOptions: {
    childList: true,
    subtree: true,
    characterData: true,
  },
};

```

* *说明：**
- `debounceDelay`: 防抖延迟，控制翻译触发频率，避免频繁操作
- `throttleTime`: 节流时间，限制单位时间内的最大翻译次数
- `enableCache`: 是否启用翻译结果缓存
- `cacheSizeLimit`: 缓存的最大条目数
- `mutationObserverOptions`: DOM变化监听的配置选项

## 页面模式设置

```javascript

const CONFIG = {
  // 页面模式配置
  pageModes: {
    // 仓库页面模式
    repository: {
      enabled: true,
      priority: 10,
    },
    // Issues页面模式
    issues: {
      enabled: true,
      priority: 9,
    },
    // Pull Requests页面模式
    pullRequests: {
      enabled: true,
      priority: 9,
    },
    // 代码页面模式
    code: {
      enabled: true,
      translateCode: false,
    },
    // 全局页面模式
    global: {
      enabled: true,
      priority: 1,
    },
  },
};

```

* *说明：**
- 不同页面模式可以有不同的翻译策略
- `enabled`: 控制该页面模式是否启用
- `priority`: 优先级，数字越大优先级越高
- `translateCode`: 该页面模式是否翻译代码内容

## 高级选项

```javascript

const CONFIG = {
  // 是否启用调试模式
  debug: false,
  // 是否在控制台输出性能数据
  logPerformance: false,
  // 最大翻译重试次数
  maxRetries: 3,
  // 重试间隔（毫秒）
  retryInterval: 1000,
  // 是否忽略特定元素的翻译
  ignoreElements: [
    'pre',
    'code',
    '.language-*',
    '.blob-code',
  ],
};

```

* *说明：**
- `debug`: 是否启用调试模式，开启后会在控制台输出更多信息
- `logPerformance`: 是否记录性能数据
- `maxRetries`: 翻译失败时的最大重试次数
- `retryInterval`: 重试间隔时间
- `ignoreElements`: 定义不进行翻译的元素选择器

## 🔧 如何修改配置

1. 在用户脚本管理器中编辑GitHub_i18n脚本
2. 找到`CONFIG`对象定义部分
3. 修改相应的配置值
4. 保存修改
5. 刷新GitHub页面使配置生效

## 💡 配置建议

## 性能优化建议

- 对于性能较弱的设备：
  ```javascript
  const CONFIG = {
    debounceDelay: 300,    // 增加防抖延迟
    throttleTime: 2000,    // 增加节流时间
    enableCache: true,     // 确保启用缓存
    cacheSizeLimit: 2000,  // 适当减少缓存大小
  };
  ```

- 对于大型复杂页面：
  ```javascript
  const CONFIG = {
    translateCode: false,      // 禁用代码翻译
    translateLinks: false,     // 可考虑禁用链接翻译
    ignoreElements: [          // 增加忽略元素
      'pre',
      'code',
      '.language-*',
      '.blob-code',
      '.file-line',
      '.commit-desc',
    ],
  };
  ```

## 学习用途建议

如果您希望通过对照来学习英文术语：

```javascript

const CONFIG = {
  showOriginalText: true,  // 显示原始英文文本
};

```

## 📊 性能监控

插件内置了性能监控功能，可以帮助您了解插件的运行状态和性能表现。

## 访问性能监控

1. 点击插件图标打开配置界面
2. 切换到"性能监控"选项卡
3. 查看实时性能统计数据

## 性能监控指标

- **翻译启动时间**：插件开始翻译的时间戳
- **处理元素数量**：已翻译的DOM元素数量
- **DOM操作时间**：DOM操作的总耗时（毫秒）
- **网络请求时间**：网络请求的总耗时（毫秒）
- **缓存命中次数**：翻译缓存命中的次数
- **缓存未命中次数**：翻译缓存未命中的次数
- **缓存命中率**：缓存命中次数占总请求数的百分比
- **平均DOM操作时间**：每次DOM操作的平均耗时
- **平均网络请求时间**：每次网络请求的平均耗时

## 导出性能数据

您可以通过配置界面的"导出数据"按钮将性能数据导出为JSON文件，用于进一步分析。

## 性能监控API

```javascript

// 获取性能统计数据
const stats = window.translationCore.getPerformanceStats();

// 导出完整性能数据
const data = window.translationCore.exportPerformanceData();

// 重置性能数据
window.translationCore.resetPerformanceData();

```

## 🚨 注意事项

1. 修改配置时请确保JavaScript语法正确
2. 不要随意修改核心翻译逻辑
3. 更改配置后，建议刷新多个不同类型的GitHub页面测试
4. 如遇到问题，可以恢复默认配置并重新安装插件
5. 性能监控功能默认启用，无需额外配置

## 版本信息

{% include "_fragments/版本信息.md" %}
作者：Sut

状态：已发布

## 更新记录
- 2024-10-13：添加性能监控功能说明
