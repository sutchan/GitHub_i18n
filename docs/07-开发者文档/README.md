# 07-开发者文档

## 目录说明

此目录包含 GitHub 中文翻译插件的开发者文档，为希望参与项目开发、贡献代码或了解项目技术实现的开发者提供参考。

## 包含文件

- **01-开发环境搭建.md**: 如何搭建本地开发环境
- **02-项目结构说明.md**: 项目代码结构和文件组织
- **03-开发流程指南.md**: 推荐的开发工作流程
- **04-翻译词典维护.md**: 如何维护和更新翻译词典
- **05-测试指南.md**: 项目测试方法和最佳实践
- **06-性能优化.md**: 性能优化策略和方法
- **07-安全注意事项.md**: 开发过程中的安全考量

## 项目概述

GitHub 中文翻译插件是一个基于 JavaScript 开发的浏览器用户脚本，主要包含两个核心组件：

1. **用户脚本**: 在浏览器中运行的前端代码，负责页面监控和翻译
2. **自动化工具**: 用于维护和更新翻译词典的辅助工具

## 技术栈

- **主要语言**: JavaScript (ES6+)
- **核心 API**: MutationObserver、DOM API
- **开发工具**: Node.js、npm/yarn
- **测试框架**: Jest
- **构建工具**: 自定义构建脚本
- **版本控制**: Git

## 开发环境搭建

### 前置条件

- Node.js (v14 或更高版本)
- npm 或 yarn
- Git
- 现代浏览器 (Chrome、Firefox 等)
- 用户脚本管理器 (推荐 Tampermonkey)

### 基础设置

1. **克隆代码仓库**
   ```bash
   git clone https://github.com/sutchan/GitHub_i18n.git
   cd GitHub_i18n
   ```

2. **安装依赖**
   ```bash
   npm install
   # 或
   yarn install
   ```

3. **构建项目**
   ```bash
   npm run build
   # 或
   yarn build
   ```

4. **安装开发版本**
   - 构建完成后，在 `dist` 目录中找到生成的用户脚本
   - 在本地浏览器中安装该脚本进行测试

## 项目结构

项目采用模块化架构，代码组织清晰：

```
GitHub_i18n/
├── src/                # 源代码目录
│   ├── config.js       # 配置文件
│   ├── dictionaries/   # 翻译词典
│   ├── translationCore.js # 翻译核心逻辑
│   ├── pageMonitor.js  # 页面监控
│   ├── versionChecker.js # 版本检查
│   ├── utils.js        # 工具函数
│   └── main.js         # 入口文件
├── dist/               # 构建产物
├── test/               # 测试文件
├── build/              # 构建脚本
└── docs/               # 项目文档
```

## 开发流程

### 常规开发流程

1. **创建分支**
   ```bash
   git checkout -b feature/your-feature-name
   ```

2. **修改代码**
   - 遵循项目代码规范
   - 添加适当的注释
   - 确保功能正常

3. **运行测试**
   ```bash
   npm test
   ```

4. **构建并测试**
   ```bash
   npm run build
   ```
   在浏览器中测试构建后的脚本

5. **提交更改**
   ```bash
   git add .
   git commit -m "描述你的更改"
   ```

6. **推送分支**
   ```bash
   git push origin feature/your-feature-name
   ```

7. **创建 Pull Request**
   - 在 GitHub 上创建 PR
   - 描述你的更改和目的
   - 等待代码审核

### 翻译词典更新流程

1. 编辑 `src/dictionaries/` 目录下的词典文件
2. 遵循词典格式规范
3. 运行测试确保格式正确
4. 提交更改并创建 PR

## 代码规范

### JavaScript 编码规范

- 使用 ES6+ 语法
- 使用 `const` 和 `let` 而非 `var`
- 优先使用箭头函数
- 代码缩进使用 2 个空格
- 每行不超过 100 个字符
- 函数和变量命名使用 camelCase
- 类名使用 PascalCase

### 注释规范

- 添加函数级注释，说明功能、参数和返回值
- 复杂逻辑添加内联注释
- 代码修改时更新相关注释

### 安全规范

- 禁止使用 `innerHTML` 进行 DOM 操作
- 对用户输入进行适当的验证和转义
- 避免 ReDoS 攻击，检查正则表达式

## 测试指南

### 单元测试

```bash
npm test
```

### 集成测试

构建项目后，在浏览器中安装并测试完整功能。

### 性能测试

使用浏览器开发工具监控插件性能，关注：
- 页面加载时间
- JavaScript 执行时间
- 内存使用情况

## 调试技巧

### 浏览器调试

1. 打开浏览器开发工具 (F12)
2. 在 Console 面板查看日志输出
3. 在 Sources 面板设置断点调试
4. 使用 Performance 面板分析性能

### 本地开发模式

开发时可以使用开发模式，启用详细日志：

```javascript
// 在 config.js 中设置
const DEBUG = true;
```

## 贡献指南

我们欢迎各种形式的贡献：

1. **代码贡献**
   - 修复 bug
   - 实现新功能
   - 性能优化

2. **翻译贡献**
   - 改进翻译质量
   - 补充缺失翻译
   - 校正错误翻译

3. **文档贡献**
   - 改进现有文档
   - 编写新文档
   - 修正文档错误

4. **测试贡献**
   - 编写测试用例
   - 报告 bug
   - 提供使用反馈

详细的贡献流程请参考 [项目贡献指南](../10-附录/03-贡献指南.md)。

## 版本发布流程

1. 更新版本号 (遵循语义化版本规范)
2. 更新 CHANGELOG.md
3. 运行测试确保功能正常
4. 构建项目
5. 创建发布标签
6. 发布到 GitHub 和 Greasy Fork

## 常见开发问题

### 翻译不生效

- 检查词典格式是否正确
- 确认选择器是否匹配目标元素
- 检查页面监控逻辑是否正常

### 性能问题

- 检查是否有不必要的 DOM 操作
- 优化正则表达式
- 实现节流或防抖机制

## 联系与支持

- **GitHub Issues**: [提交问题](https://github.com/sutchan/GitHub_i18n/issues)
- **讨论区**: [参与讨论](https://github.com/sutchan/GitHub_i18n/discussions)

## 版本信息

- **当前版本**: 1.8.60
- **发布日期**: 2024-01
- **文档状态**: 活跃维护中

---

*详细的开发指南请参考各子文档。如有开发相关问题，请提交 issue 或参与项目讨论。*