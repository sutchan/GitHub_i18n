<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GitHub 中文翻译 - 自动字符串更新工具</title>
  <!-- 页面管理样式 -->
  <link rel="stylesheet" href="page_manager.css">
  <style>
    /* 基础样式 - 优化版 */
    :root {
      /* 主色调 */
      --primary-color: #2563eb;
      --primary-hover: #1d4ed8;
      --primary-light: #dbeafe;

      /* 辅助色 */
      --success-color: #10b981;
      --success-hover: #059669;
      --success-light: #d1fae5;

      --warning-color: #f59e0b;
      --warning-light: #fef3c7;

      --danger-color: #ef4444;
      --danger-hover: #dc2626;
      --danger-light: #fee2e2;

      /* 中性色 */
      --text-primary: #1f2937;
      --text-secondary: #6b7280;
      --text-muted: #9ca3af;

      --bg-primary: #ffffff;
      --bg-secondary: #f9fafb;
      --bg-tertiary: #f3f4f6;
      --bg-dark: #1e293b;

      /* 边框色 */
      --border-light: #e5e7eb;
      --border-medium: #d1d5db;
      --border-dark: #9ca3af;

      /* 阴影 */
      --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
      --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
      --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
      --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);

      /* 圆角 */
      --radius-sm: 0.25rem;
      --radius: 0.375rem;
      --radius-md: 0.5rem;
      --radius-lg: 0.75rem;

      /* 间距 */
      --spacing-xs: 0.25rem;
      --spacing-sm: 0.5rem;
      --spacing: 1rem;
      --spacing-lg: 1.5rem;
      --spacing-xl: 2rem;

      /* 过渡 */
      --transition-fast: 0.15s ease-in-out;
      --transition: 0.2s ease-in-out;
      --transition-slow: 0.3s ease-in-out;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      line-height: 1.6;
      color: var(--text-primary);
      max-width: 1200px;
      margin: 0 auto;
      padding: var(--spacing);
      background-color: var(--bg-secondary);
      font-size: 16px;
    }

    /* 页面头部 - 优化版 */
    header {
      background: linear-gradient(135deg, var(--primary-color), var(--primary-hover));
      color: white;
      padding: var(--spacing-lg);
      border-radius: var(--radius-lg);
      margin-bottom: var(--spacing-lg);
      text-align: center;
      box-shadow: var(--shadow-md);
      transition: transform var(--transition), box-shadow var(--transition);
    }

    header:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    h1 {
      margin: 0;
      font-size: 1.875rem;
      font-weight: 600;
    }

    .subtitle {
      font-size: 1rem;
      opacity: 0.9;
      margin-top: var(--spacing-sm);
    }

    /* 主容器布局 - 优化版 */
    .container {
      display: grid;
      grid-template-columns: 1fr 2fr;
      gap: var(--spacing-lg);
      margin-bottom: var(--spacing-lg);
    }

    /* 配置面板和主内容区 - 优化版 */
    .config-panel,
    .main-content {
      background-color: var(--bg-primary);
      border-radius: var(--radius-lg);
      padding: var(--spacing-lg);
      box-shadow: var(--shadow);
      transition: box-shadow var(--transition);
    }

    .config-panel:hover,
    .main-content:hover {
      box-shadow: var(--shadow-md);
    }

    h2 {
      font-size: 1.25rem;
      margin-bottom: var(--spacing);
      color: var(--text-primary);
      border-bottom: 2px solid var(--primary-color);
      padding-bottom: var(--spacing-sm);
    }

    /* 配置组 - 优化版 */
    .config-group {
      margin-bottom: var(--spacing);
    }

    .config-group label {
      display: block;
      margin-bottom: var(--spacing-xs);
      font-weight: 500;
      color: var(--text-primary);
    }

    /* 表单元素样式 - 优化版 */
    .config-group input[type="text"],
    .config-group input[type="number"],
    .config-group select {
      width: 100%;
      padding: 0.5rem 0.75rem;
      border: 1px solid var(--border-medium);
      border-radius: var(--radius);
      font-size: 0.875rem;
      transition: border-color var(--transition), box-shadow var(--transition);
      background-color: var(--bg-primary);
    }

    .config-group input[type="text"]:focus,
    .config-group input[type="number"]:focus,
    .config-group select:focus {
      border-color: var(--primary-color);
      outline: none;
      box-shadow: 0 0 0 3px var(--primary-light);
    }

    .config-group textarea {
      width: 100%;
      padding: 0.5rem 0.75rem;
      border: 1px solid var(--border-medium);
      border-radius: var(--radius);
      font-size: 0.875rem;
      min-height: 100px;
      font-family: 'JetBrains Mono', 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
      resize: vertical;
      transition: border-color var(--transition), box-shadow var(--transition);
      background-color: var(--bg-primary);
    }

    .config-group textarea:focus {
      border-color: var(--primary-color);
      outline: none;
      box-shadow: 0 0 0 3px var(--primary-light);
    }

    /* 复选框样式 - 优化版 */
    .config-group input[type="checkbox"] {
      margin-right: var(--spacing-xs);
      accent-color: var(--primary-color);
    }

    .checkbox-label {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
      cursor: pointer;
      transition: color var(--transition);
    }

    .checkbox-label:hover {
      color: var(--primary-color);
    }

    /* 按钮样式 - 优化版 */
    .btn {
      background-color: var(--primary-color);
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: var(--radius);
      font-size: 0.875rem;
      cursor: pointer;
      transition: all var(--transition);
      font-weight: 500;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }

    .btn-info {
      background-color: #3b82f6;
      --btn-hover-bg: #2563eb;
    }

    .btn-info:hover:not(:disabled) {
      background-color: var(--btn-hover-bg, var(--primary-hover));
    }

    .btn:hover:not(:disabled) {
      background-color: var(--primary-hover);
      box-shadow: var(--shadow-md);
    }

    .btn:focus {
      outline: none;
      box-shadow: 0 0 0 3px var(--primary-light);
    }

    .btn:active {
      transform: translateY(1px);
    }

    .btn:disabled {
      background-color: var(--border-dark);
      cursor: not-allowed;
      opacity: 0.7;
      transform: none;
    }

    .btn-group {
      display: flex;
      gap: var(--spacing-sm);
      margin-bottom: var(--spacing);
      flex-wrap: wrap;
    }

    /* 日志区域 - 优化版 */
    .log-area {
      background-color: var(--bg-dark);
      color: #e2e8f0;
      padding: var(--spacing);
      border-radius: var(--radius);
      font-family: 'JetBrains Mono', 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
      font-size: 0.875rem;
      min-height: 300px;
      max-height: 500px;
      overflow-y: auto;
      white-space: pre-wrap;
      border: 1px solid #334155;
    }

    /* 结果区域 */
    .results-area {
      margin-top: var(--spacing);
    }

    /* 统计卡片 - 优化版 */
    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: var(--spacing);
      margin-bottom: var(--spacing);
    }

    .stat-card {
      background-color: var(--bg-tertiary);
      padding: var(--spacing);
      border-radius: var(--radius-md);
      text-align: center;
      border: 1px solid var(--border-light);
      transition: all var(--transition);
    }

    .stat-card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
      border-color: var(--primary-color);
    }

    .stat-number {
      font-size: 1.75rem;
      font-weight: 700;
      color: var(--primary-color);
      margin-bottom: var(--spacing-xs);
    }

    .stat-label {
      color: var(--text-secondary);
      font-size: 0.875rem;
    }

    /* 表格样式 - 优化版 */
    .strings-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: var(--spacing);
      font-size: 0.875rem;
    }

    .strings-table th,
    .strings-table td {
      border: 1px solid var(--border-light);
      padding: 0.75rem;
      text-align: left;
    }

    .strings-table th {
      background-color: var(--bg-tertiary);
      font-weight: 600;
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .strings-table tr:hover {
      background-color: var(--bg-secondary);
    }

    .strings-table-container {
      max-height: 400px;
      overflow-y: auto;
      border: 1px solid var(--border-light);
      border-radius: var(--radius);
      position: relative;
    }

    .strings-table-wrapper {
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }

    /* 状态标签 - 优化版 */
    .status {
      display: inline-block;
      padding: 0.25rem 0.625rem;
      border-radius: 9999px;
      font-size: 0.75rem;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .status-new {
      background-color: var(--success-light);
      color: #065f46;
    }

    .status-exists {
      background-color: var(--primary-light);
      color: #1e40af;
    }

    /* 页脚 - 优化版 */
    .footer {
      margin-top: var(--spacing-xl);
      padding-top: var(--spacing);
      border-top: 1px solid var(--border-light);
      text-align: center;
      color: var(--text-secondary);
      font-size: 0.875rem;
    }

    .version-info {
      margin-top: var(--spacing-xs);
      font-size: 0.75rem;
    }

    /* 选项卡 - 优化版 */
    .tabs {
      display: flex;
      border-bottom: 1px solid var(--border-light);
      margin-bottom: var(--spacing);
      overflow-x: auto;
      padding-bottom: 5px;
      scrollbar-width: none;
    }

    .tabs::-webkit-scrollbar {
      display: none;
    }

    .tab {
      padding: 0.75rem 1.25rem;
      cursor: pointer;
      border-bottom: 2px solid transparent;
      white-space: nowrap;
      transition: all var(--transition);
      font-weight: 500;
      color: var(--text-secondary);
    }

    .tab:hover {
      background-color: var(--bg-secondary);
      color: var(--primary-color);
    }

    .tab.active {
      color: var(--primary-color);
      border-bottom-color: var(--primary-color);
      background-color: var(--bg-secondary);
    }

    .tab-content {
      display: none;
      animation: fadeIn var(--transition-slow) ease-in-out;
    }

    .tab-content.active {
      display: block;
    }

    /* 动画 - 新增 */
    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(5px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes pulse {

      0%,
      100% {
        opacity: 1;
      }

      50% {
        opacity: 0.7;
      }
    }

    /* 加载动画 - 优化版 */
    .loading {
      display: inline-block;
      width: 16px;
      height: 16px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 0.8s linear infinite;
    }

    .loading-container {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 200px;
      animation: pulse 1.5s ease-in-out infinite;
    }

    /* 滚动条样式 - 优化版 */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    ::-webkit-scrollbar-track {
      background: var(--bg-tertiary);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb {
      background: var(--border-dark);
      border-radius: 4px;
      transition: background var(--transition);
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #888;
    }

    /* 响应式设计 - 增强版 */
    /* 超大屏幕 */
    @media (min-width: 1400px) {
      .container {
        grid-template-columns: 350px 1fr;
        max-width: 1600px;
        margin: 0 auto;
      }

      .stat-number {
        font-size: 2rem;
      }
    }

    /* 大屏幕 */
    @media (max-width: 1399px) {
      .container {
        grid-template-columns: 320px 1fr;
        max-width: 1200px;
        margin: 0 auto;
      }
    }

    /* 中等屏幕 */
    @media (max-width: 1024px) {
      .container {
        grid-template-columns: 1fr;
        max-width: 900px;
        margin: 0 auto;
      }

      .config-panel {
        border-right: none;
        border-bottom: 1px solid var(--border-light);
        margin-bottom: var(--spacing-lg);
      }
    }

    /* 平板设备 */
    @media (max-width: 768px) {
      body {
        padding: var(--spacing-md);
      }

      header,
      .config-panel,
      .main-content {
        padding: var(--spacing-md);
      }

      h1 {
        font-size: 1.75rem;
      }

      h2 {
        font-size: 1.25rem;
      }

      .stats {
        grid-template-columns: repeat(2, 1fr);
      }

      .strings-table th,
      .strings-table td {
        padding: 0.5rem;
        font-size: 0.8rem;
      }

      .strings-table-container {
        max-height: 300px;
      }
    }

    /* 移动设备 - 横屏 */
    @media (max-width: 640px) {
      body {
        padding: var(--spacing-sm);
        font-size: 0.9rem;
      }

      header,
      .config-panel,
      .main-content {
        padding: var(--spacing-sm);
      }

      h1 {
        font-size: 1.5rem;
      }

      .subtitle {
        font-size: 0.875rem;
      }

      .btn-group {
        flex-direction: column;
        gap: var(--spacing-sm);
      }

      .btn {
        width: 100%;
        padding: 0.75rem;
      }
    }

    /* 移动设备 - 竖屏 */
    @media (max-width: 480px) {
      .stats {
        grid-template-columns: 1fr;
        gap: var(--spacing-sm);
      }

      .stat-number {
        font-size: 1.25rem;
      }

      .config-group label {
        font-size: 0.875rem;
      }

      .config-group input,
      .config-group select,
      .config-group textarea {
        font-size: 0.875rem;
        padding: 0.5rem;
        min-height: 44px;
        /* 触摸友好的高度 */
      }

      .tabs {
        padding-bottom: 3px;
        scrollbar-width: thin;
      }

      .tab {
        padding: 0.75rem 0.75rem;
        /* 增大点击区域 */
        font-size: 0.875rem;
        min-height: 44px;
        /* 触摸友好的高度 */
        display: flex;
        align-items: center;
      }

      .checkbox-label {
        margin-bottom: 0.75rem;
      }

      .checkbox-label input[type="checkbox"] {
        width: 18px;
        height: 18px;
        margin-right: 0.5rem;
      }

      .strings-table th,
      .strings-table td {
        padding: 0.6rem 0.4rem;
        font-size: 0.75rem;
        white-space: nowrap;
      }

      /* 表格标题最小宽度，确保内容可读性 */
      .strings-table th {
        min-width: 80px;
      }

      /* 优化移动端触摸反馈 */
      .btn,
      .tab,
      .checkbox-label {
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
      }
    }

    /* 极小型设备 */
    @media (max-width: 360px) {
      body {
        padding: var(--spacing-xs);
      }

      header,
      .config-panel,
      .main-content {
        padding: var(--spacing-xs);
      }

      h1 {
        font-size: 1.25rem;
      }

      .strings-table-container {
        max-height: 200px;
      }
    }
  </style>
</head>

<body>
  <header>
    <h1>GitHub 中文翻译</h1>
    <p class="subtitle">自动字符串更新工具</p>
  </header>

  <div class="container">
    <div class="config-panel">
      <h2>配置选项</h2>

      <div class="config-group">
        <label for="repo-path">仓库路径:</label>
        <input type="text" id="repo-path" placeholder="输入仓库路径">
      </div>

      <div class="config-group">
        <label for="branch">分支:</label>
        <select id="branch">
          <option value="main">main</option>
          <option value="master">master</option>
          <option value="develop">develop</option>
        </select>
      </div>

      <div class="config-group">
        <label for="source-language">源语言:</label>
        <select id="source-language">
          <option value="en">英文 (en)</option>
        </select>
      </div>

      <div class="config-group">
        <label for="target-language">目标语言:</label>
        <select id="target-language">
          <option value="zh-CN">中文简体 (zh-CN)</option>
        </select>
      </div>

      <div class="config-group">
        <label for="file-patterns">文件匹配模式:</label>
        <textarea id="file-patterns" placeholder="输入文件匹配模式，每行一个"></textarea>
      </div>

      <div class="config-group">
        <label>高级选项:</label>
        <div class="checkbox-label">
          <input type="checkbox" id="include-comments">
          <span>包含注释中的字符串</span>
        </div>
        <div class="checkbox-label">
          <input type="checkbox" id="ignore-html-tags">
          <span>忽略HTML标签</span>
        </div>
        <div class="checkbox-label">
          <input type="checkbox" id="min-length-only">
          <span>仅提取最小长度的字符串</span>
        </div>
      </div>

      <div class="config-group">
        <label for="min-length">最小字符串长度:</label>
        <input type="number" id="min-length" value="3">
      </div>

      <div class="btn-group">
        <button id="start-btn" class="btn">开始提取</button>
        <button id="stop-btn" class="btn" disabled>停止提取</button>
        <button id="reset-btn" class="btn">重置</button>
      </div>
    </div>

    <div class="main-content">
      <div class="tabs">
        <div class="tab active" data-tab="logs">日志输出</div>
        <div class="tab" data-tab="results">提取结果</div>
        <div class="tab" data-tab="advanced">高级设置</div>
        <div class="tab" data-tab="pageManager">页面管理</div>
      </div>

      <div id="logs-content" class="tab-content active">
        <div class="log-area" id="log-area">
          欢迎使用 GitHub 中文翻译自动字符串更新工具！

          请在左侧配置仓库路径和其他选项，然后点击"开始提取"按钮。
        </div>
      </div>

      <div id="results-content" class="tab-content">
        <div class="stats">
          <div class="stat-card">
            <div class="stat-number" id="total-strings">0</div>
            <div class="stat-label">总字符串数</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="new-strings">0</div>
            <div class="stat-label">新字符串数</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="existing-strings">0</div>
            <div class="stat-label">已存在字符串数</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="processed-files">0</div>
            <div class="stat-label">处理文件数</div>
          </div>
        </div>

        <div class="strings-table-container">
          <div class="strings-table-wrapper">
            <table class="strings-table">
              <thead>
                <tr>
                  <th>字符串</th>
                  <th>文件路径</th>
                  <th>行号</th>
                  <th>状态</th>
                </tr>
              </thead>
              <tbody id="strings-table-body">
                <!-- 字符串将动态添加到这里 -->
              </tbody>
            </table>
          </div>
        </div>

        <div class="btn-group">
          <button id="export-btn" class="btn" disabled>导出结果</button>
          <button id="save-config-btn" class="btn">保存配置</button>
          <button id="load-config-btn" class="btn">加载配置</button>
        </div>
      </div>

      <div id="advanced-content" class="tab-content">
        <div class="config-group">
          <label for="regex-pattern">正则表达式模式:</label>
          <textarea id="regex-pattern" placeholder="自定义字符串匹配正则表达式"></textarea>
        </div>

        <div class="config-group">
          <label>排除选项:</label>
          <div class="checkbox-label">
            <input type="checkbox" id="exclude-numbers">
            <span>排除纯数字</span>
          </div>
          <div class="checkbox-label">
            <input type="checkbox" id="exclude-short-strings">
            <span>排除短字符串</span>
          </div>
          <div class="checkbox-label">
            <input type="checkbox" id="exclude-urls">
            <span>排除URLs</span>
          </div>
        </div>

        <div class="config-group">
          <label for="max-concurrent-files">最大并发文件数:</label>
          <input type="number" id="max-concurrent-files" value="10">
        </div>

        <div class="config-group">
          <label for="encoding">文件编码:</label>
          <select id="encoding">
            <option value="utf-8">UTF-8</option>
            <option value="utf-16">UTF-16</option>
            <option value="latin1">ISO-8859-1</option>
          </select>
        </div>

        <button id="apply-settings-btn" class="btn">应用设置</button>
      </div>

      <div id="pageManager-content" class="tab-content">
        <!-- 页面管理部分的HTML结构 -->
        <div id="pageManagerContainer" class="page-manager-container">
          <div class="page-manager">
            <!-- 工具栏 -->
            <div class="toolbar">
              <button id="addPageBtn" class="btn btn-primary">添加页面</button>
              <button id="editPageBtn" class="btn btn-secondary" disabled>编辑页面</button>
              <button id="deletePageBtn" class="btn btn-danger" disabled>删除选中</button>
              <button id="toggleStatusBtn" class="btn btn-secondary" disabled>启用/禁用</button>
              <button id="importPagesBtn" class="btn btn-info">导入页面</button>
              <button id="collectStringsBtn" class="btn btn-primary">采集字符串</button>
              <div id="pageStatistics">
                <div class="stat-item total">总数: <span id="totalPages">0</span></div>
                <div class="stat-item enabled">启用: <span id="enabledPages">0</span></div>
                <div class="stat-item disabled">禁用: <span id="disabledPages">0</span></div>
                <div class="stat-item selected">选中: <span id="selectedPages">0</span></div>
              </div>
            </div>

            <!-- 进度条 -->
            <div id="collectionProgress">
              <div class="progress-container">
                <div class="progress-bar" style="width: 0%"></div>
                <div class="progress-text">准备中...</div>
              </div>
            </div>

            <!-- 页面表格 -->
            <div id="tableWrapper">
              <table id="pageTable">
                <thead>
                  <tr>
                    <th style="width: 40px;"><input type="checkbox" id="selectAllCheckbox" class="page-checkbox"></th>
                    <th>页面名称</th>
                    <th>URL 模式</th>
                    <th>选择器</th>
                    <th>优先级</th>
                    <th>状态</th>
                    <th style="width: 100px;">操作</th>
                  </tr>
                </thead>
                <tbody id="pageTableBody">
                  <!-- 页面数据将通过 JavaScript 动态生成 -->
                  <tr>
                    <td colspan="7" style="text-align: center; padding: 40px; color: #6a737d;">
                      加载页面配置中...
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <!-- 页面表单 -->
            <div id="pageForm">
              <h3 id="pageFormTitle">添加页面</h3>
              <div class="form-row">
                <div class="form-group">
                  <label for="pageId">页面 ID</label>
                  <input type="text" id="pageId" placeholder="唯一标识符">
                </div>
                <div class="form-group">
                  <label for="pageName">页面名称</label>
                  <input type="text" id="pageName" placeholder="页面显示名称">
                </div>
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label for="pagePattern">URL 模式</label>
                  <input type="text" id="pagePattern" placeholder="URL 匹配模式，支持正则表达式">
                </div>
                <div class="form-group">
                  <label for="pagePriority">优先级</label>
                  <input type="number" id="pagePriority" min="1" max="10" value="5" placeholder="1-10">
                </div>
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label for="pageSelectors">CSS 选择器</label>
                  <textarea id="pageSelectors" placeholder="CSS 选择器，多个选择器用逗号分隔" rows="4"></textarea>
                </div>
              </div>
              <div class="form-row">
                <div class="form-checkbox">
                  <input type="checkbox" id="pageEnabled" checked>
                  <label for="pageEnabled">启用此页面</label>
                </div>
              </div>
              <div class="form-actions">
                <button id="cancelFormBtn" class="btn btn-secondary">取消</button>
                <button id="savePageBtn" class="btn btn-primary">保存</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <footer class="footer">
    <div>GitHub 中文翻译项目</div>
    <div class="version-info">版本 1.0.0</div>
  </footer>

  <script>
    // 应用状态管理
    const appState = {
      isExtracting: false,
      extractionInterval: null,
      stats: {
        totalStrings: 0,
        newStrings: 0,
        existingStrings: 0,
        processedFiles: 0
      },
      currentTab: 'logs',
      notifications: []
    };

    // DOM 元素缓存系统 - 增强版
    const elements = {
      // 配置面板
      repoPath: document.getElementById('repo-path'),
      branch: document.getElementById('branch'),
      sourceLanguage: document.getElementById('source-language'),
      targetLanguage: document.getElementById('target-language'),
      filePatterns: document.getElementById('file-patterns'),
      includeComments: document.getElementById('include-comments'),
      ignoreHtmlTags: document.getElementById('ignore-html-tags'),
      minLengthOnly: document.getElementById('min-length-only'),
      minLength: document.getElementById('min-length'),
      startBtn: document.getElementById('start-btn'),
      stopBtn: document.getElementById('stop-btn'),
      resetBtn: document.getElementById('reset-btn'),

      // 结果面板
      logArea: document.getElementById('log-area'),
      totalStrings: document.getElementById('total-strings'),
      newStrings: document.getElementById('new-strings'),
      existingStrings: document.getElementById('existing-strings'),
      processedFiles: document.getElementById('processed-files'),
      stringsTableBody: document.getElementById('strings-table-body'),
      exportBtn: document.getElementById('export-btn'),
      saveConfigBtn: document.getElementById('save-config-btn'),
      loadConfigBtn: document.getElementById('load-config-btn'),

      // 高级设置
      regexPattern: document.getElementById('regex-pattern'),
      excludeNumbers: document.getElementById('exclude-numbers'),
      excludeShortStrings: document.getElementById('exclude-short-strings'),
      excludeUrls: document.getElementById('exclude-urls'),
      maxConcurrentFiles: document.getElementById('max-concurrent-files'),
      encoding: document.getElementById('encoding'),
      applySettingsBtn: document.getElementById('apply-settings-btn'),

      // 选项卡
      tabs: document.querySelectorAll('.tab'),
      tabContents: document.querySelectorAll('.tab-content')
    };

    // 日志输出函数 - 增强版
    function log(message, type = 'info') {
      const timestamp = new Date().toLocaleTimeString();

      // 日志类型配置
      const logTypes = {
        info: { prefix: '[信息]', className: 'log-info' },
        error: { prefix: '[错误]', className: 'log-error' },
        success: { prefix: '[成功]', className: 'log-success' },
        warning: { prefix: '[警告]', className: 'log-warning' }
      };

      const { prefix, className } = logTypes[type] || logTypes.info;

      // 创建日志元素而不是简单添加文本
      const logEntry = document.createElement('div');
      logEntry.className = `log-entry ${className}`;
      logEntry.textContent = `${timestamp} ${prefix} ${message}`;

      // 添加到日志区域
      elements.logArea.appendChild(logEntry);
      elements.logArea.scrollTop = elements.logArea.scrollHeight;

      // 如果是错误，同时显示通知
      if (type === 'error') {
        showNotification(message, 'error');
      }
    }

    // 用户通知功能 - 新增
    function showNotification(message, type = 'info') {
      // 创建通知元素
      const notification = document.createElement('div');
      notification.className = `notification notification-${type}`;
      notification.textContent = message;

      // 添加到页面
      document.body.appendChild(notification);

      // 添加入场动画
      setTimeout(() => notification.classList.add('show'), 10);

      // 自动关闭
      setTimeout(() => {
        notification.classList.remove('show');
        setTimeout(() => document.body.removeChild(notification), 300);
      }, 5000);
    }

    // 配置验证函数 - 新增
    function validateConfig() {
      const errors = [];

      // 验证仓库路径
      if (!elements.repoPath.value.trim()) {
        errors.push('请输入仓库路径');
      }

      // 验证文件匹配模式
      if (!elements.filePatterns.value.trim()) {
        errors.push('请输入文件匹配模式');
      }

      // 验证最小长度
      const minLength = parseInt(elements.minLength.value);
      if (isNaN(minLength) || minLength < 1) {
        errors.push('最小字符串长度必须大于0');
      }

      // 显示错误
      if (errors.length > 0) {
        errors.forEach(error => log(error, 'error'));
        return false;
      }

      return true;
    }

    // 模拟字符串数据
    const mockStrings = [
      { text: 'Hello, world!', file: 'src/app.js', line: 10, isNew: true },
      { text: 'Welcome to GitHub', file: 'src/welcome.js', line: 25, isNew: false },
      { text: 'Save changes', file: 'src/editor.js', line: 42, isNew: true },
      { text: 'Cancel', file: 'src/modal.js', line: 15, isNew: false },
      { text: 'Submit pull request', file: 'src/pullrequest.js', line: 67, isNew: true },
      { text: 'Create new repository', file: 'src/repo.js', line: 30, isNew: true },
      { text: 'Clone repository', file: 'src/clone.js', line: 18, isNew: false },
      { text: 'Push changes', file: 'src/push.js', line: 55, isNew: true },
      { text: 'Pull changes', file: 'src/pull.js', line: 40, isNew: false },
      { text: 'Merge branch', file: 'src/merge.js', line: 62, isNew: true }
    ];

    // UI状态更新函数 - 新增
    function updateUIState() {
      // 更新按钮状态
      elements.startBtn.disabled = appState.isExtracting;
      elements.stopBtn.disabled = !appState.isExtracting;
      elements.exportBtn.disabled = appState.stats.totalStrings === 0;

      // 添加加载指示器
      if (appState.isExtracting) {
        elements.startBtn.innerHTML = '<span class="loading"></span> 提取中...';
      } else {
        elements.startBtn.textContent = '开始提取';
      }
    }

    // 开始提取
    function startExtraction() {
      // 验证配置
      if (!validateConfig()) {
        return;
      }

      appState.isExtracting = true;
      updateUIState();

      // 重置统计数据
      appState.stats = {
        totalStrings: 0,
        newStrings: 0,
        existingStrings: 0,
        processedFiles: 0
      };
      updateStats(true); // true表示使用动画

      // 清空表格
      clearStringsTable();

      log('开始提取字符串...', 'info');
      log(`配置: 仓库路径=${elements.repoPath.value}, 分支=${elements.branch.value}`, 'info');

      // 显示成功通知
      showNotification('开始提取字符串', 'success');

      // 模拟提取过程
      simulateExtraction();
    }

    // 停止提取
    function stopExtraction() {
      appState.isExtracting = false;
      if (appState.extractionInterval) {
        clearInterval(appState.extractionInterval);
        appState.extractionInterval = null;
      }

      updateUIState();
      log('提取已停止', 'warning');
    }

    // 模拟提取过程 - 增强版
    function simulateExtraction() {
      let currentIndex = 0;
      const totalItems = mockStrings.length;

      // 模拟一些错误场景
      const errorChance = 0.1; // 10%的错误几率

      appState.extractionInterval = setInterval(() => {
        try {
          if (!appState.isExtracting || currentIndex >= totalItems) {
            clearInterval(appState.extractionInterval);
            appState.extractionInterval = null;

            if (appState.isExtracting) {
              appState.isExtracting = false;
              updateUIState();
              log('提取完成!', 'success');
              showNotification('字符串提取已完成', 'success');
            }
            return;
          }

          // 模拟随机错误
          if (Math.random() < errorChance) {
            throw new Error('模拟文件读取错误');
          }

          const stringData = mockStrings[currentIndex];
          addStringToTable(stringData);

          // 随机增加已处理文件数
          if (Math.random() > 0.7) {
            appState.stats.processedFiles++;
            updateStats();
            log(`已处理文件: ${appState.stats.processedFiles}`, 'info');
          }

          currentIndex++;

          // 更新进度
          const progress = Math.round((currentIndex / totalItems) * 100);
          if (progress % 20 === 0) {
            log(`提取进度: ${progress}%`, 'info');
          }

        } catch (error) {
          log(`处理过程中出错: ${error.message}`, 'error');
          // 继续处理，不中断整个过程
          currentIndex++;
        }
      }, 600); // 稍微加快处理速度
    }

    // 添加字符串到表格 - 增强版
    function addStringToTable(stringData) {
      const row = document.createElement('tr');
      row.className = 'string-row'; // 添加类用于动画

      // 字符串单元格 - 支持长文本截断
      const textCell = document.createElement('td');
      textCell.textContent = stringData.text;
      textCell.title = stringData.text; // 添加悬停提示
      textCell.className = 'string-text';

      // 文件路径单元格
      const fileCell = document.createElement('td');
      fileCell.textContent = stringData.file;
      fileCell.className = 'string-file';

      // 行号单元格
      const lineCell = document.createElement('td');
      lineCell.textContent = stringData.line;
      lineCell.className = 'string-line';

      // 状态单元格
      const statusCell = document.createElement('td');
      const statusSpan = document.createElement('span');
      statusSpan.className = `status ${stringData.isNew ? 'status-new' : 'status-exists'}`;
      statusSpan.textContent = stringData.isNew ? '新' : '已存在';
      statusCell.appendChild(statusSpan);

      // 添加单元格到行
      row.appendChild(textCell);
      row.appendChild(fileCell);
      row.appendChild(lineCell);
      row.appendChild(statusCell);

      // 添加行到表格
      elements.stringsTableBody.appendChild(row);

      // 添加动画效果
      setTimeout(() => row.classList.add('fade-in'), 10);

      // 自动滚动到最后一行
      elements.stringsTableBody.scrollTop = elements.stringsTableBody.scrollHeight;

      // 更新统计
      appState.stats.totalStrings++;
      if (stringData.isNew) {
        appState.stats.newStrings++;
      } else {
        appState.stats.existingStrings++;
      }
      updateStats(true); // 使用动画
    }

    // 清空字符串表格
    function clearStringsTable() {
      elements.stringsTableBody.innerHTML = '';
    }

    // 更新统计数据 - 增强版带动画
    function updateStats(withAnimation = false) {
      const statsElements = {
        totalStrings: elements.totalStrings,
        newStrings: elements.newStrings,
        existingStrings: elements.existingStrings,
        processedFiles: elements.processedFiles
      };

      // 为每个统计数字添加动画
      if (withAnimation) {
        Object.entries(statsElements).forEach(([key, element]) => {
          // 添加闪烁效果
          element.classList.add('stat-update');
          setTimeout(() => element.classList.remove('stat-update'), 300);

          // 添加数字计数动画
          const targetValue = appState.stats[key];
          const currentValue = parseInt(element.textContent) || 0;
          const difference = targetValue - currentValue;

          if (difference !== 0) {
            let startTime;
            const duration = 500; // 动画持续时间

            function animateCount(timestamp) {
              if (!startTime) startTime = timestamp;
              const progress = Math.min((timestamp - startTime) / duration, 1);

              // 使用缓动函数
              const easeOutQuart = 1 - Math.pow(1 - progress, 4);
              const currentCount = Math.floor(currentValue + (difference * easeOutQuart));

              element.textContent = currentCount;

              if (progress < 1) {
                requestAnimationFrame(animateCount);
              } else {
                element.textContent = targetValue;
              }
            }

            requestAnimationFrame(animateCount);
          }
        });
      } else {
        // 无动画直接更新
        Object.entries(statsElements).forEach(([key, element]) => {
          element.textContent = appState.stats[key];
        });
      }
    }

    // 重置功能 - 增强版
    function resetConfig() {
      // 添加确认对话框
      if (appState.isExtracting) {
        showNotification('正在提取中，无法重置', 'warning');
        return;
      }

      // 重置表单
      elements.repoPath.value = '';
      elements.branch.value = 'main';
      elements.filePatterns.value = '';
      elements.includeComments.checked = false;
      elements.ignoreHtmlTags.checked = false;
      elements.minLengthOnly.checked = false;
      elements.minLength.value = 3;

      // 重置统计
      appState.stats = {
        totalStrings: 0,
        newStrings: 0,
        existingStrings: 0,
        processedFiles: 0
      };
      updateStats();

      // 清空表格
      clearStringsTable();

      // 清空日志 - 添加保留初始信息
      elements.logArea.innerHTML = '';
      log('配置已重置', 'success');

      // 更新UI状态
      updateUIState();

      // 显示成功通知
      showNotification('配置已重置', 'success');
    }

    // 保存配置 - 增强版
    function saveConfig() {
      const config = {
        repoPath: elements.repoPath.value,
        branch: elements.branch.value,
        sourceLanguage: elements.sourceLanguage.value,
        targetLanguage: elements.targetLanguage.value,
        filePatterns: elements.filePatterns.value,
        includeComments: elements.includeComments.checked,
        ignoreHtmlTags: elements.ignoreHtmlTags.checked,
        minLengthOnly: elements.minLengthOnly.checked,
        minLength: parseInt(elements.minLength.value),
        regexPattern: elements.regexPattern.value,
        excludeNumbers: elements.excludeNumbers.checked,
        excludeShortStrings: elements.excludeShortStrings.checked,
        excludeUrls: elements.excludeUrls.checked,
        maxConcurrentFiles: parseInt(elements.maxConcurrentFiles.value),
        encoding: elements.encoding.value,
        savedAt: new Date().toISOString() // 添加保存时间
      };

      try {
        localStorage.setItem('github-i18n-config', JSON.stringify(config));
        log('配置已保存', 'success');
        showNotification('配置保存成功', 'success');
      } catch (error) {
        log(`保存配置失败: ${error.message}`, 'error');
      }
    }

    // 加载配置 - 增强版
    function loadConfig() {
      try {
        const configJson = localStorage.getItem('github-i18n-config');
        if (configJson) {
          const config = JSON.parse(configJson);

          // 更新表单值
          elements.repoPath.value = config.repoPath || '';
          elements.branch.value = config.branch || 'main';
          elements.sourceLanguage.value = config.sourceLanguage || 'en';
          elements.targetLanguage.value = config.targetLanguage || 'zh-CN';
          elements.filePatterns.value = config.filePatterns || '';
          elements.includeComments.checked = config.includeComments || false;
          elements.ignoreHtmlTags.checked = config.ignoreHtmlTags || false;
          elements.minLengthOnly.checked = config.minLengthOnly || false;
          elements.minLength.value = config.minLength || 3;
          elements.regexPattern.value = config.regexPattern || '';
          elements.excludeNumbers.checked = config.excludeNumbers || false;
          elements.excludeShortStrings.checked = config.excludeShortStrings || false;
          elements.excludeUrls.checked = config.excludeUrls || false;
          elements.maxConcurrentFiles.value = config.maxConcurrentFiles || 10;
          elements.encoding.value = config.encoding || 'utf-8';

          // 显示保存时间
          if (config.savedAt) {
            const savedTime = new Date(config.savedAt).toLocaleString();
            log(`配置已加载 (保存时间: ${savedTime})`, 'success');
          } else {
            log('配置已加载', 'success');
          }

          showNotification('配置加载成功', 'success');
        } else {
          log('没有找到保存的配置', 'warning');
          showNotification('没有找到保存的配置', 'info');
        }
      } catch (error) {
        log(`加载配置失败: ${error.message}`, 'error');
      }
    }

    // 初始化选项卡 - 增强版
    function setupTabs() {
      elements.tabs.forEach(tab => {
        tab.addEventListener('click', () => {
          const tabId = tab.getAttribute('data-tab');

          // 防止重复点击
          if (appState.currentTab === tabId) return;

          appState.currentTab = tabId;

          // 更新选项卡状态 - 添加过渡动画
          elements.tabs.forEach(t => {
            t.classList.remove('active');
            t.classList.add('inactive');
          });

          // 先隐藏所有内容
          elements.tabContents.forEach(content => {
            content.classList.remove('active');
            content.classList.add('fade-out');

            setTimeout(() => {
              content.classList.remove('fade-out');
            }, 200);
          });

          // 延迟显示新内容以获得更好的过渡效果
          setTimeout(() => {
            tab.classList.remove('inactive');
            tab.classList.add('active');

            const newContent = document.getElementById(`${tabId}-content`);
            newContent.classList.add('active');
          }, 100);
        });
      });
    }

    // 导出结果 - 增强版
    function exportResults() {
      if (appState.stats.totalStrings === 0) {
        log('没有可导出的结果', 'error');
        showNotification('没有可导出的结果', 'error');
        return;
      }

      log('开始导出结果...', 'info');

      // 模拟导出进度
      elements.exportBtn.disabled = true;
      elements.exportBtn.innerHTML = '<span class="loading"></span> 导出中...';

      // 模拟进度更新
      let progress = 0;
      const progressInterval = setInterval(() => {
        progress += 20;
        if (progress <= 100) {
          log(`导出进度: ${progress}%`, 'info');
        }
        if (progress >= 100) {
          clearInterval(progressInterval);

          setTimeout(() => {
            const filename = `github-i18n-results-${new Date().toISOString().slice(0, 10)}.json`;
            log(`导出完成! 文件名: ${filename}`, 'success');
            showNotification(`导出成功: ${filename}`, 'success');

            elements.exportBtn.disabled = false;
            elements.exportBtn.textContent = '导出结果';
          }, 500);
        }
      }, 300);
    }

    // 应用高级设置
    function applyAdvancedSettings() {
      log('已应用高级设置', 'success');
      showNotification('高级设置已应用', 'success');
    }

    // 初始化键盘快捷键 - 新增
    function initKeyboardShortcuts() {
      document.addEventListener('keydown', (e) => {
        // Ctrl/Cmd + S 保存配置
        if ((e.ctrlKey || e.metaKey) && e.key === 's') {
          e.preventDefault();
          saveConfig();
        }

        // Ctrl/Cmd + L 加载配置
        if ((e.ctrlKey || e.metaKey) && e.key === 'l') {
          e.preventDefault();
          loadConfig();
        }

        // Ctrl/Cmd + R 重置配置
        if ((e.ctrlKey || e.metaKey) && e.key === 'r') {
          e.preventDefault();
          resetConfig();
        }

        // 空格键开始/停止提取
        if (e.key === ' ' && e.target.tagName !== 'INPUT' && e.target.tagName !== 'TEXTAREA') {
          e.preventDefault();
          if (appState.isExtracting) {
            stopExtraction();
          } else {
            startExtraction();
          }
        }
      });
    }

    // 窗口大小变化监听 - 新增
    function initResizeHandler() {
      window.addEventListener('resize', () => {
        // 在响应式设计中可能需要的调整
        // 这里可以添加针对不同屏幕尺寸的特殊处理
      });
    }

    // 初始化事件监听 - 增强版
    function initEventListeners() {
      // 按钮事件
      elements.startBtn.addEventListener('click', startExtraction);
      elements.stopBtn.addEventListener('click', stopExtraction);
      elements.resetBtn.addEventListener('click', resetConfig);
      elements.exportBtn.addEventListener('click', exportResults);
      elements.saveConfigBtn.addEventListener('click', saveConfig);
      elements.loadConfigBtn.addEventListener('click', loadConfig);
      elements.applySettingsBtn.addEventListener('click', applyAdvancedSettings);

      // 表单元素变化监听 - 新增
      elements.repoPath.addEventListener('input', validateConfig);
      elements.filePatterns.addEventListener('input', validateConfig);
      elements.minLength.addEventListener('change', validateConfig);

      // 初始化选项卡
      setupTabs();

      // 初始化键盘快捷键
      initKeyboardShortcuts();

      // 初始化窗口大小变化处理
      initResizeHandler();

      // 添加鼠标悬停效果到统计卡片
      document.querySelectorAll('.stat-card').forEach(card => {
        card.addEventListener('mouseenter', () => {
          card.style.transform = 'translateY(-3px) scale(1.02)';
        });

        card.addEventListener('mouseleave', () => {
          card.style.transform = 'translateY(0) scale(1)';
        });
      });
    }

    // 添加通知样式 - 新增
    function addNotificationStyles() {
      const style = document.createElement('style');
      style.textContent = `
        /* 通知样式 */
        .notification {
          position: fixed;
          top: 20px;
          right: 20px;
          padding: 12px 20px;
          border-radius: var(--radius);
          color: white;
          font-weight: 500;
          z-index: 1000;
          opacity: 0;
          transform: translateX(100%);
          transition: all 0.3s ease-in-out;
          box-shadow: var(--shadow-lg);
        }

        .notification.show {
          opacity: 1;
          transform: translateX(0);
        }

        .notification-info {
          background-color: var(--primary-color);
        }

        .notification-success {
          background-color: var(--success-color);
        }

        .notification-error {
          background-color: var(--danger-color);
        }

        .notification-warning {
          background-color: var(--warning-color);
        }

        /* 日志条目样式 */
        .log-entry {
          margin-bottom: 4px;
          padding: 4px 0;
          border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .log-error {
          color: #fca5a5;
          font-weight: 500;
        }

        .log-success {
          color: #86efac;
        }

        .log-warning {
          color: #fcd34d;
        }

        /* 统计数字更新动画 */
        .stat-update {
          animation: statPulse 0.3s ease-in-out;
        }

        @keyframes statPulse {
          0%, 100% { transform: scale(1); }
          50% { transform: scale(1.1); color: var(--primary-color); }
        }

        /* 表格行动画 */
        .string-row {
          opacity: 0;
          transform: translateY(10px);
          transition: all 0.3s ease-in-out;
        }

        .string-row.fade-in {
          opacity: 1;
          transform: translateY(0);
        }

        /* 字符串文本单元格样式 */
        .string-text {
          max-width: 200px;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
        }

        /* 选项卡过渡 */
        .tab.inactive {
          opacity: 0.6;
        }

        .fade-out {
          opacity: 0;
          transform: translateY(5px);
        }
      `;
      document.head.appendChild(style);
    }

    // 初始化页面 - 增强版
    function initialize() {
      // 添加通知样式
      addNotificationStyles();

      log('欢迎使用 GitHub 中文翻译自动字符串更新工具！', 'info');
      log('请在左侧配置仓库路径和其他选项，然后点击"开始提取"按钮。', 'info');

      // 初始化事件监听
      initEventListeners();

      // 初始化页面管理器
      if (typeof initPageManager !== 'undefined') {
        initPageManager();
      }

      // 更新UI状态
      updateUIState();

      // 尝试加载保存的配置
      try {
        const savedConfig = localStorage.getItem('github-i18n-config');
        if (savedConfig) {
          setTimeout(() => {
            loadConfig();
          }, 1000); // 稍微延迟加载配置，让用户看到欢迎信息
        }
      } catch (error) {
        // 静默失败，不影响用户使用
      }
    }

    // 页面加载完成后初始化
    document.addEventListener('DOMContentLoaded', initialize);
  </script>

  <!-- 页面管理相关脚本 -->
  <script src="page_manager.js"></script>
  <script src="page_manager_ui.js"></script>
</body>

</html>
