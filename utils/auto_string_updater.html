<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GitHub ä¸­æ–‡ç¿»è¯‘ - è‡ªåŠ¨å­—ç¬¦ä¸²æ›´æ–°å·¥å…·</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      line-height: 1.6;
      color: #333;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      background-color: #f5f5f5;
    }

    header {
      background-color: #24292e;
      color: white;
      padding: 30px;
      border-radius: 8px;
      margin-bottom: 30px;
      text-align: center;
    }

    h1 {
      margin: 0;
      font-size: 28px;
    }

    .subtitle {
      font-size: 16px;
      opacity: 0.8;
      margin-top: 10px;
    }

    .container {
      display: grid;
      grid-template-columns: 1fr 2fr;
      gap: 20px;
      margin-bottom: 30px;
    }

    .config-panel {
      background-color: white;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .main-content {
      background-color: white;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    h2 {
      font-size: 20px;
      margin-bottom: 20px;
      color: #24292e;
      border-bottom: 2px solid #0366d6;
      padding-bottom: 8px;
    }

    .config-group {
      margin-bottom: 20px;
    }

    .config-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
      color: #24292e;
    }

    .config-group input[type="text"],
    .config-group input[type="number"],
    .config-group select {
      width: 100%;
      padding: 8px;
      border: 1px solid #e1e4e8;
      border-radius: 4px;
      font-size: 14px;
    }

    .config-group textarea {
      width: 100%;
      padding: 8px;
      border: 1px solid #e1e4e8;
      border-radius: 4px;
      font-size: 14px;
      min-height: 100px;
      font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
    }

    .config-group input[type="checkbox"] {
      margin-right: 8px;
    }

    .checkbox-label {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
    }

    .btn {
      background-color: #0366d6;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      font-size: 16px;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .btn:hover {
      background-color: #0256c9;
    }

    .btn:disabled {
      background-color: #94d3a2;
      cursor: not-allowed;
    }

    .btn-group {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }

    .log-area {
      background-color: #f6f8fa;
      padding: 15px;
      border-radius: 6px;
      font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
      font-size: 14px;
      min-height: 300px;
      max-height: 500px;
      overflow-y: auto;
      white-space: pre-wrap;
    }

    .results-area {
      margin-top: 20px;
    }

    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }

    .stat-card {
      background-color: #f6f8fa;
      padding: 15px;
      border-radius: 6px;
      text-align: center;
    }

    .stat-number {
      font-size: 24px;
      font-weight: bold;
      color: #0366d6;
    }

    .stat-label {
      color: #586069;
      font-size: 14px;
    }

    .strings-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    .strings-table th,
    .strings-table td {
      border: 1px solid #e1e4e8;
      padding: 10px;
      text-align: left;
    }

    .strings-table th {
      background-color: #f6f8fa;
      font-weight: 500;
    }

    .strings-table tr:hover {
      background-color: #f6f8fa;
    }

    .strings-table-container {
      max-height: 400px;
      overflow-y: auto;
    }

    .status {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 500;
    }

    .status-new {
      background-color: #dcffe4;
      color: #28a745;
    }

    .status-exists {
      background-color: #ffe5dc;
      color: #cb2431;
    }

    .footer {
      margin-top: 40px;
      padding-top: 20px;
      border-top: 1px solid #e1e4e8;
      text-align: center;
      color: #586069;
      font-size: 14px;
    }

    .version-info {
      margin-top: 5px;
      font-size: 12px;
    }

    .tabs {
      display: flex;
      border-bottom: 1px solid #e1e4e8;
      margin-bottom: 20px;
    }

    .tab {
      padding: 10px 20px;
      cursor: pointer;
      border-bottom: 2px solid transparent;
    }

    .tab.active {
      border-bottom-color: #0366d6;
      color: #0366d6;
      font-weight: 500;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    @media (max-width: 768px) {
      .container {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>

<body>
  <header>
    <h1>GitHub ä¸­æ–‡ç¿»è¯‘ - è‡ªåŠ¨å­—ç¬¦ä¸²æ›´æ–°å·¥å…·</h1>
    <div class="subtitle">ç”¨äºè‡ªåŠ¨åŒ–ä»GitHubç½‘ç«™æŠ“å–å­—ç¬¦ä¸²å¹¶æ›´æ–°ç¿»è¯‘è¯å…¸</div>
  </header>

  <div class="container">
    <div class="config-panel">
      <h2>é…ç½®é€‰é¡¹</h2>

      <div class="config-group">
        <label for="userScriptPath">ç”¨æˆ·è„šæœ¬è·¯å¾„</label>
        <input type="text" id="userScriptPath" value="../GitHub_zh-CN.user.js" placeholder="ç”¨æˆ·è„šæœ¬æ–‡ä»¶è·¯å¾„">
      </div>

      <div class="config-group">
        <label for="minStringLength">æœ€å°å­—ç¬¦ä¸²é•¿åº¦</label>
        <input type="number" id="minStringLength" value="2" min="1">
      </div>

      <div class="config-group">
        <label for="maxStringLength">æœ€å¤§å­—ç¬¦ä¸²é•¿åº¦</label>
        <input type="number" id="maxStringLength" value="100" min="1">
      </div>

      <div class="config-group">
        <label for="concurrentRequests">å¹¶å‘è¯·æ±‚æ•°é‡</label>
        <input type="number" id="concurrentRequests" value="3" min="1" max="10">
      </div>

      <div class="config-group">
        <label for="requestDelay">è¯·æ±‚é—´éš”æ—¶é—´(ms)</label>
        <input type="number" id="requestDelay" value="1000" min="0">
      </div>

      <div class="config-group">
        <label for="logLevel">æ—¥å¿—çº§åˆ«</label>
        <select id="logLevel">
          <option value="error">Error</option>
          <option value="warn">Warn</option>
          <option value="info" selected>Info</option>
          <option value="debug">Debug</option>
        </select>
      </div>

      <div class="config-group">
        <label>è¿‡æ»¤é€‰é¡¹</label>
        <div class="checkbox-label">
          <input type="checkbox" id="exactMatchOnly" checked>
          <label for="exactMatchOnly">åªåŒ¹é…å…¨æ–‡</label>
        </div>
        <div class="checkbox-label">
          <input type="checkbox" id="saveDownloadedPages">
          <label for="saveDownloadedPages">ä¿å­˜ä¸‹è½½çš„é¡µé¢</label>
        </div>
      </div>

      <div class="config-group">
        <label for="ignoreWords">å¿½ç•¥çš„å•è¯ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰</label>
        <input type="text" id="ignoreWords" value="GitHub,API,URL,HTTP,HTTPS" placeholder="å¿½ç•¥çš„å•è¯åˆ—è¡¨">
      </div>

      <div class="config-group">
        <label for="modules">é€‰æ‹©æ¨¡å—</label>
        <textarea id="modules" placeholder="è¾“å…¥è¦å¤„ç†çš„æ¨¡å—ï¼Œä¸€è¡Œä¸€ä¸ª">global
settings
notifications
explore
search
codespaces</textarea>
      </div>

      <div class="btn-group">
        <button id="startBtn" class="btn">å¼€å§‹æå–</button>
        <button id="stopBtn" class="btn" disabled>åœæ­¢</button>
      </div>

      <div class="btn-group">
        <button id="resetConfigBtn" class="btn">é‡ç½®é…ç½®</button>
        <button id="saveConfigBtn" class="btn">ä¿å­˜é…ç½®</button>
      </div>
    </div>

    <div class="main-content">
      <div class="tabs">
        <div class="tab active" data-tab="log">æ—¥å¿—è¾“å‡º</div>
        <div class="tab" data-tab="results">æå–ç»“æœ</div>
        <div class="tab" data-tab="settings">é«˜çº§è®¾ç½®</div>
      </div>

      <div id="log-content" class="tab-content active">
        <div class="log-area" id="logArea">å‡†å¤‡å°±ç»ª...</div>
      </div>

      <div id="results-content" class="tab-content">
        <div class="stats">
          <div class="stat-card">
            <div class="stat-number" id="extractedCount">0</div>
            <div class="stat-label">æå–çš„å­—ç¬¦ä¸²</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="addedCount">0</div>
            <div class="stat-label">æ–°å¢çš„å­—ç¬¦ä¸²</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="skippedCount">0</div>
            <div class="stat-label">è·³è¿‡çš„å­—ç¬¦ä¸²</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="errorCount">0</div>
            <div class="stat-label">é”™è¯¯æ•°é‡</div>
          </div>
        </div>

        <div class="strings-table-container">
          <table class="strings-table">
            <thead>
              <tr>
                <th>åºå·</th>
                <th>å­—ç¬¦ä¸²å†…å®¹</th>
                <th>æ¨¡å—</th>
                <th>çŠ¶æ€</th>
              </tr>
            </thead>
            <tbody id="stringsTableBody">
              <!-- æå–çš„å­—ç¬¦ä¸²å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
            </tbody>
          </table>
        </div>
      </div>

      <div id="settings-content" class="tab-content">
        <div class="config-group">
          <label for="backupDir">å¤‡ä»½ç›®å½•</label>
          <input type="text" id="backupDir" value="../backups" placeholder="å¤‡ä»½æ–‡ä»¶ç›®å½•">
        </div>

        <div class="config-group">
          <label for="httpTimeout">HTTPè¶…æ—¶æ—¶é—´(ms)</label>
          <input type="number" id="httpTimeout" value="30000" min="1000">
        </div>

        <div class="config-group">
          <label for="maxRetries">æœ€å¤§é‡è¯•æ¬¡æ•°</label>
          <input type="number" id="maxRetries" value="3" min="0">
        </div>

        <div class="config-group">
          <label for="retryDelay">é‡è¯•å»¶è¿Ÿ(ms)</label>
          <input type="number" id="retryDelay" value="2000" min="0">
        </div>

        <div class="config-group">
          <label for="userAgent">User Agent</label>
          <input type="text" id="userAgent"
            value="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36"
            placeholder="User Agentå­—ç¬¦ä¸²">
        </div>

        <div class="config-group">
          <label for="downloadedPagesDir">ä¸‹è½½é¡µé¢ä¿å­˜ç›®å½•</label>
          <input type="text" id="downloadedPagesDir" value="../debug/pages" placeholder="ä¸‹è½½é¡µé¢ä¿å­˜ç›®å½•">
        </div>

        <div class="config-group">
          <label for="ignorePatterns">å¿½ç•¥çš„æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ï¼ˆæ¯è¡Œä¸€ä¸ªï¼‰</label>
          <textarea id="ignorePatterns" placeholder="å¿½ç•¥çš„æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼"></textarea>
        </div>

        <div class="config-group">
          <label for="includePatterns">å¿…é¡»åŒ…å«çš„æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ï¼ˆæ¯è¡Œä¸€ä¸ªï¼‰</label>
          <textarea id="includePatterns" placeholder="å¿…é¡»åŒ…å«çš„æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼"></textarea>
        </div>
      </div>
    </div>
  </div>

  <div class="footer">
    <div>GitHub ä¸­æ–‡ç¿»è¯‘æ’ä»¶ (GitHub_i18n) - è‡ªåŠ¨å­—ç¬¦ä¸²æ›´æ–°å·¥å…·</div>
    <div class="version-info">Â© 2023 Sut. ç‰ˆæœ¬ 1.8.16</div>
  </div>

  <script>
    // åˆå§‹åŒ–å˜é‡
    let isRunning = false;
    let extractedStrings = [];
    let currentStep = 0;
    let totalSteps = 5;

    // DOM å…ƒç´ 
    const startBtn = document.getElementById('startBtn');
    const stopBtn = document.getElementById('stopBtn');
    const resetConfigBtn = document.getElementById('resetConfigBtn');
    const saveConfigBtn = document.getElementById('saveConfigBtn');
    const logArea = document.getElementById('logArea');
    const stringsTableBody = document.getElementById('stringsTableBody');
    const extractedCount = document.getElementById('extractedCount');
    const addedCount = document.getElementById('addedCount');
    const skippedCount = document.getElementById('skippedCount');
    const errorCount = document.getElementById('errorCount');
    const tabs = document.querySelectorAll('.tab');
    const tabContents = document.querySelectorAll('.tab-content');

    // åˆå§‹æ—¥å¿—
    function log(message, level = 'info') {
      const timestamp = new Date().toLocaleTimeString();
      const levelClass = level === 'error' ? 'color: #cb2431;' :
        level === 'warn' ? 'color: #d73a49;' :
          level === 'debug' ? 'color: #005cc5;' : '';

      logArea.innerHTML += `[${timestamp}] <span style="${levelClass}">${message}</span>\n`;
      logArea.scrollTop = logArea.scrollHeight;
    }

    // å¼€å§‹æå–è¿‡ç¨‹
    function startExtraction() {
      isRunning = true;
      startBtn.disabled = true;
      stopBtn.disabled = false;

      extractedStrings = [];
      updateStats();
      clearStringsTable();

      log('å¼€å§‹å­—ç¬¦ä¸²æå–è¿‡ç¨‹...');

      // æ¨¡æ‹Ÿæå–è¿‡ç¨‹
      simulateExtraction();
    }

    // åœæ­¢æå–è¿‡ç¨‹
    function stopExtraction() {
      isRunning = false;
      startBtn.disabled = false;
      stopBtn.disabled = true;
      log('æå–è¿‡ç¨‹å·²åœæ­¢', 'warn');
    }

    // æ¨¡æ‹Ÿæå–è¿‡ç¨‹
    async function simulateExtraction() {
      try {
        // æ­¥éª¤1: åŠ è½½é…ç½®
        log('æ­¥éª¤ 1/5: åŠ è½½é…ç½®...');
        await sleep(1000);
        log('âœ… é…ç½®åŠ è½½å®Œæˆ');

        if (!isRunning) return;

        // æ­¥éª¤2: è·å–é¡µé¢åˆ—è¡¨
        log('æ­¥éª¤ 2/5: è·å–é¡µé¢åˆ—è¡¨...');
        await sleep(1000);
        log('âœ… é¡µé¢åˆ—è¡¨è·å–å®Œæˆï¼Œå…± 5 ä¸ªé¡µé¢');

        if (!isRunning) return;

        // æ­¥éª¤3: ä¸‹è½½é¡µé¢
        log('æ­¥éª¤ 3/5: å¼€å§‹ä¸‹è½½é¡µé¢...');
        const pages = ['GitHubé¦–é¡µ', 'è®¾ç½®é¡µé¢', 'é€šçŸ¥é¡µé¢', 'æ¢ç´¢é¡µé¢', 'æœç´¢é¡µé¢'];

        for (let i = 0; i < pages.length; i++) {
          if (!isRunning) break;
          log(`æ­£åœ¨ä¸‹è½½: ${pages[i]} (${i + 1}/${pages.length})`);
          await sleep(800);
        }

        if (!isRunning) return;

        // æ­¥éª¤4: æå–å­—ç¬¦ä¸²
        log('æ­¥éª¤ 4/5: å¼€å§‹ä»é¡µé¢æå–å­—ç¬¦ä¸²...');

        // æ¨¡æ‹Ÿæå–çš„å­—ç¬¦ä¸²
        const mockStrings = [
          { text: 'Sign in', module: 'global', status: 'new' },
          { text: 'Get started', module: 'global', status: 'new' },
          { text: 'Create repository', module: 'global', status: 'exists' },
          { text: 'Your profile', module: 'settings', status: 'new' },
          { text: 'Notifications', module: 'notifications', status: 'exists' },
          { text: 'Trending repositories', module: 'explore', status: 'new' },
          { text: 'Search GitHub', module: 'search', status: 'new' },
          { text: 'Code', module: 'global', status: 'exists' },
          { text: 'Issues', module: 'global', status: 'exists' },
          { text: 'Pull requests', module: 'global', status: 'exists' }
        ];

        for (let i = 0; i < mockStrings.length; i++) {
          if (!isRunning) break;
          extractedStrings.push(mockStrings[i]);
          addStringToTable(mockStrings[i], i + 1);
          updateStats();
          await sleep(300);
        }

        if (!isRunning) return;

        // æ­¥éª¤5: æ›´æ–°è¯å…¸
        log('æ­¥éª¤ 5/5: å‡†å¤‡æ›´æ–°ç¿»è¯‘è¯å…¸...');
        await sleep(1000);
        log('âœ… ç¿»è¯‘è¯å…¸æ›´æ–°å®Œæˆ');

        if (!isRunning) return;

        // å®Œæˆ
        log('ğŸ‰ å­—ç¬¦ä¸²æå–å’Œæ›´æ–°è¿‡ç¨‹å·²å®Œæˆ!', 'info');
        log(`ğŸ“Š ç»Ÿè®¡: æå– ${extractedStrings.length} ä¸ªå­—ç¬¦ä¸²ï¼Œæ–°å¢ ${extractedStrings.filter(s => s.status === 'new').length} ä¸ªï¼Œè·³è¿‡ ${extractedStrings.filter(s => s.status === 'exists').length} ä¸ª`);

      } catch (error) {
        log(`é”™è¯¯: ${error.message}`, 'error');
      } finally {
        isRunning = false;
        startBtn.disabled = false;
        stopBtn.disabled = true;
      }
    }

    // æ·»åŠ å­—ç¬¦ä¸²åˆ°è¡¨æ ¼
    function addStringToTable(stringObj, index) {
      const row = document.createElement('tr');

      const indexCell = document.createElement('td');
      indexCell.textContent = index;

      const textCell = document.createElement('td');
      textCell.textContent = stringObj.text;

      const moduleCell = document.createElement('td');
      moduleCell.textContent = stringObj.module;

      const statusCell = document.createElement('td');
      const statusSpan = document.createElement('span');
      statusSpan.className = `status status-${stringObj.status}`;
      statusSpan.textContent = stringObj.status === 'new' ? 'æ–°å¢' : 'å·²å­˜åœ¨';
      statusCell.appendChild(statusSpan);

      row.appendChild(indexCell);
      row.appendChild(textCell);
      row.appendChild(moduleCell);
      row.appendChild(statusCell);

      stringsTableBody.appendChild(row);
    }

    // æ¸…ç©ºå­—ç¬¦ä¸²è¡¨æ ¼
    function clearStringsTable() {
      stringsTableBody.innerHTML = '';
    }

    // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
    function updateStats() {
      extractedCount.textContent = extractedStrings.length;
      addedCount.textContent = extractedStrings.filter(s => s.status === 'new').length;
      skippedCount.textContent = extractedStrings.filter(s => s.status === 'exists').length;
      // é”™è¯¯æ•°é‡å¯ä»¥æ ¹æ®å®é™…æƒ…å†µæ›´æ–°
    }

    // é‡ç½®é…ç½®
    function resetConfig() {
      if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰é…ç½®ä¸ºé»˜è®¤å€¼å—ï¼Ÿ')) {
        document.getElementById('userScriptPath').value = '../GitHub_zh-CN.user.js';
        document.getElementById('minStringLength').value = '2';
        document.getElementById('maxStringLength').value = '100';
        document.getElementById('concurrentRequests').value = '3';
        document.getElementById('requestDelay').value = '1000';
        document.getElementById('logLevel').value = 'info';
        document.getElementById('exactMatchOnly').checked = true;
        document.getElementById('saveDownloadedPages').checked = false;
        document.getElementById('ignoreWords').value = 'GitHub,API,URL,HTTP,HTTPS';
        document.getElementById('modules').value = 'global\nsettings\nnotifications\nexplore\nsearch\ncodespaces';
        document.getElementById('backupDir').value = '../backups';
        document.getElementById('httpTimeout').value = '30000';
        document.getElementById('maxRetries').value = '3';
        document.getElementById('retryDelay').value = '2000';
        document.getElementById('userAgent').value = 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36';
        document.getElementById('downloadedPagesDir').value = '../debug/pages';
        document.getElementById('ignorePatterns').value = '';
        document.getElementById('includePatterns').value = '';

        log('é…ç½®å·²é‡ç½®ä¸ºé»˜è®¤å€¼', 'info');
      }
    }

    // ä¿å­˜é…ç½®
    function saveConfig() {
      // è¿™é‡Œå¯ä»¥å®ç°é…ç½®ä¿å­˜é€»è¾‘
      log('é…ç½®å·²ä¿å­˜', 'info');
      alert('é…ç½®å·²ä¿å­˜ï¼');
    }

    // é€‰é¡¹å¡åˆ‡æ¢
    function setupTabs() {
      tabs.forEach(tab => {
        tab.addEventListener('click', () => {
          // ç§»é™¤æ‰€æœ‰æ´»åŠ¨çŠ¶æ€
          tabs.forEach(t => t.classList.remove('active'));
          tabContents.forEach(content => content.classList.remove('active'));

          // æ·»åŠ å½“å‰æ´»åŠ¨çŠ¶æ€
          tab.classList.add('active');
          const tabId = tab.getAttribute('data-tab');
          document.getElementById(`${tabId}-content`).classList.add('active');
        });
      });
    }

    // è¾…åŠ©å‡½æ•°ï¼šå»¶è¿Ÿ
    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }

    // äº‹ä»¶ç›‘å¬å™¨
    startBtn.addEventListener('click', startExtraction);
    stopBtn.addEventListener('click', stopExtraction);
    resetConfigBtn.addEventListener('click', resetConfig);
    saveConfigBtn.addEventListener('click', saveConfig);

    // åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', function () {
      setupTabs();
      log('å·¥å…·å·²åˆå§‹åŒ–ï¼Œç‚¹å‡»ã€Œå¼€å§‹æå–ã€æŒ‰é’®å¼€å§‹å¤„ç†');
    });
  </script>
</body>

</html>
