// ==UserScript==
// @name         GitHub ç½‘ç«™å›½é™…åŒ–ä¹‹ä¸­æ–‡ç¿»è¯‘
// @namespace    https://github.com/Tanox/GitHub_i18n
// @version      1.3
// @description  ä½¿ç”¨é¢„å®šä¹‰è¯å…¸å®ç° GitHub å…¨ç«™é«˜é¢‘ UI ä¸­æ–‡ç¿»è¯‘ï¼Œä¿®å¤èœå•å‚ç›´æ’åˆ—é—®é¢˜ï¼Œé›¶å»¶è¿Ÿã€ä¸ç ´åå¸ƒå±€
// @author       Sut
// @match        https://github.com/Tanox/GitHub_i18n/blob/main/GitHub_zh-CN.userjs
// @grant        none
// @icon         https://github.githubassets.com/favicons/favicon.svg
// ==/UserScript==

(function () {
    'use strict';

    // ğŸ”¤ å®Œæ•´é¢„å®šä¹‰ç¿»è¯‘è¯å…¸ï¼ˆè¦†ç›–å¯¼èˆªã€ä¸ªäººèœå•ã€è®¾ç½®ã€ç»„ç»‡ã€é€šçŸ¥ç­‰ï¼‰
const TRANSLATION_DICT = {
    // ========== é¡¶éƒ¨å…¨å±€å¯¼èˆª ==========
    'Pull requests': 'æ‹‰å–è¯·æ±‚',
    'Issues': 'é—®é¢˜',
    'Actions': 'æ“ä½œ',
    'Projects': 'é¡¹ç›®',
    'Wiki': 'ç»´åŸº',
    'Security': 'å®‰å…¨',
    'Insights': 'æ´å¯Ÿ',
    'Settings': 'è®¾ç½®',
    'Code': 'ä»£ç ',
    'Discussions': 'è®¨è®º',
    'Marketplace': 'å¸‚åœº',
    'Explore': 'æ¢ç´¢',
    'Copilot': 'Copilot',
    'Notifications': 'é€šçŸ¥',
    'New repository': 'æ–°å»ºä»“åº“',
    'Import repository': 'å¯¼å…¥ä»“åº“',
    'New gist': 'æ–°å»ºä»£ç ç‰‡æ®µ',
    'New organization': 'æ–°å»ºç»„ç»‡',
    'New codespace': 'æ–°å»º Codespace',
    'Your profile': 'ä¸ªäººèµ„æ–™',
    'Your repositories': 'ä½ çš„ä»“åº“',
    'Your stars': 'ä½ çš„æ ‡æ˜Ÿ',
    'Your gists': 'ä½ çš„ä»£ç ç‰‡æ®µ',
    'Your codespaces': 'ä½ çš„ Codespaces',
    'Your projects': 'ä½ çš„é¡¹ç›®',
    'Your organizations': 'ä½ çš„ç»„ç»‡',
    'Your notifications': 'ä½ çš„é€šçŸ¥',
    'Feature preview': 'åŠŸèƒ½é¢„è§ˆ',
    'Help': 'å¸®åŠ©',
    'Sign out': 'é€€å‡ºç™»å½•',
    'Signed in as': 'å·²ç™»å½•ä¸º',
    'Dashboard': 'ä»ªè¡¨ç›˜',

    // ========== ä»“åº“é¡µä¸»å¯¼èˆªï¼ˆUnderlineNavï¼‰==========
    'Overview': 'æ¦‚è§ˆ',
    'Commits': 'æäº¤',
    'Branches': 'åˆ†æ”¯',
    'Tags': 'æ ‡ç­¾',
    'Releases': 'å‘å¸ƒ',
    'Packages': 'åŒ…',
    'Environments': 'ç¯å¢ƒ',
    'Contributors': 'è´¡çŒ®è€…',
    'Activity': 'æ´»åŠ¨',
    'Dependency graph': 'ä¾èµ–å…³ç³»å›¾',
    'Dependabot': 'Dependabot',
    'Code scanning': 'ä»£ç æ‰«æ',
    'Secret scanning': 'å¯†é’¥æ‰«æ',
    'Audit log': 'å®¡è®¡æ—¥å¿—',
    'Billing': 'è´¦å•',
    'Members': 'æˆå‘˜',
    'Teams': 'å›¢é˜Ÿ',
    'Custom properties': 'è‡ªå®šä¹‰å±æ€§',
    'Moderation settings': 'å®¡æ ¸è®¾ç½®',
    'Installed GitHub Apps': 'å·²å®‰è£…çš„ GitHub åº”ç”¨',
    'Webhooks': 'Webhooks',
    'Service hooks': 'æœåŠ¡é’©å­',
    'Deploy keys': 'éƒ¨ç½²å¯†é’¥',
    'Self-hosted runners': 'è‡ªæ‰˜ç®¡è¿è¡Œå™¨',
    'Runner groups': 'è¿è¡Œå™¨ç»„',
    'Variables': 'å˜é‡',
    'Secrets': 'å¯†é’¥',
    'Environments': 'ç¯å¢ƒ',
    'Pages': 'Pages',
    'Environments': 'ç¯å¢ƒ',
    'Actions secrets': 'æ“ä½œå¯†é’¥',
    'Artifacts': 'äº§ç‰©',
    'Caches': 'ç¼“å­˜',
    'Workflows': 'å·¥ä½œæµ',
    'Runs': 'è¿è¡Œè®°å½•',
    'Summary': 'æ‘˜è¦',
    'Jobs': 'ä»»åŠ¡',
    'Logs': 'æ—¥å¿—',

    // ========== ä»“åº“æ“ä½œèœå•ï¼ˆå³ä¸Šè§’ "Code" æŒ‰é’®ä¸‹æ‹‰ï¼‰==========
    'Clone': 'å…‹éš†',
    'Open with GitHub Desktop': 'ä½¿ç”¨ GitHub Desktop æ‰“å¼€',
    'Open with Codespaces': 'ä½¿ç”¨ Codespaces æ‰“å¼€',
    'Download ZIP': 'ä¸‹è½½ ZIP',
    'Local': 'æœ¬åœ°',
    'GitHub CLI': 'GitHub CLI',
    'HTTPS': 'HTTPS',
    'GitHub CLI': 'GitHub CLI',
    'Use SSH': 'ä½¿ç”¨ SSH',
    'Use HTTPS': 'ä½¿ç”¨ HTTPS',

    // ========== Issues / PR æ“ä½œèœå• ==========
    'New issue': 'æ–°å»ºé—®é¢˜',
    'New pull request': 'æ–°å»ºæ‹‰å–è¯·æ±‚',
    'Assignees': 'è´Ÿè´£äºº',
    'Labels': 'æ ‡ç­¾',
    'Projects': 'é¡¹ç›®',
    'Milestone': 'é‡Œç¨‹ç¢‘',
    'Development': 'å¼€å‘',
    'Linked pull requests': 'å…³è”çš„æ‹‰å–è¯·æ±‚',
    'Convert to issue': 'è½¬æ¢ä¸ºé—®é¢˜',
    'Close issue': 'å…³é—­é—®é¢˜',
    'Reopen issue': 'é‡æ–°å¼€å¯é—®é¢˜',
    'Close pull request': 'å…³é—­æ‹‰å–è¯·æ±‚',
    'Ready for review': 'å‡†å¤‡å®¡æ ¸',
    'Mark as draft': 'æ ‡è®°ä¸ºè‰ç¨¿',
    'Reviewers': 'å®¡æ ¸äºº',
    'Request review': 'è¯·æ±‚å®¡æ ¸',
    'Add reaction': 'æ·»åŠ ååº”',
    'Subscribe': 'è®¢é˜…',
    'Unsubscribe': 'å–æ¶ˆè®¢é˜…',

    // ========== ä¸ªäººä¸»é¡µæ ‡ç­¾ ==========
    'Repositories': 'ä»“åº“',
    'Stars': 'æ ‡æ˜Ÿ',
    'Followers': 'å…³æ³¨è€…',
    'Following': 'å…³æ³¨ä¸­',
    'Sponsoring': 'èµåŠ©ä¸­',
    'Sponsors': 'èµåŠ©è€…',
    'Highlights': 'äº®ç‚¹',
    'Pinned': 'ç½®é¡¶',

    // ========== è®¾ç½®é¡µé¢ä¸»èœå•ï¼ˆå·¦ä¾§è¾¹æ ï¼‰==========
    'Account': 'è´¦æˆ·',
    'Profile': 'ä¸ªäººèµ„æ–™',
    'Account security': 'è´¦æˆ·å®‰å…¨',
    'Sessions': 'ç™»å½•ä¼šè¯',
    'SSH and GPG keys': 'SSH å’Œ GPG å¯†é’¥',
    'Access tokens': 'è®¿é—®ä»¤ç‰Œ',
    'Sponsored developers': 'èµåŠ©å¼€å‘è€…',
    'Organization memberships': 'ç»„ç»‡æˆå‘˜èµ„æ ¼',
    'Email': 'é‚®ç®±',
    'Public email': 'å…¬å¼€é‚®ç®±',
    'Business': 'ä¼ä¸š',
    'Connected accounts': 'å·²è¿æ¥è´¦æˆ·',
    'Block users': 'å±è”½ç”¨æˆ·',
    'Delete account': 'åˆ é™¤è´¦æˆ·',
    'Preferences': 'åå¥½è®¾ç½®',
    'Appearance': 'å¤–è§‚',
    'Accessibility': 'æ— éšœç¢',
    'Notifications': 'é€šçŸ¥',
    'Email notifications': 'é‚®ä»¶é€šçŸ¥',
    'Watched repositories': 'å…³æ³¨çš„ä»“åº“',
    'Scheduled digests': 'å®šæœŸæ‘˜è¦',
    'Integrations': 'é›†æˆ',
    'Authorized OAuth Apps': 'æˆæƒçš„ OAuth åº”ç”¨',
    'Authorized GitHub Apps': 'æˆæƒçš„ GitHub åº”ç”¨',
    'Webhooks': 'Webhooks',
    'Service hooks': 'æœåŠ¡é’©å­',
    'Billing & plans': 'è´¦å•ä¸è®¡åˆ’',
    'Developer settings': 'å¼€å‘è€…è®¾ç½®',
    'Fine-grained personal access tokens': 'ç²¾ç»†ä¸ªäººè®¿é—®ä»¤ç‰Œ',
    'Personal access tokens (classic)': 'ä¸ªäººè®¿é—®ä»¤ç‰Œï¼ˆç»å…¸ï¼‰',
    'OAuth Apps': 'OAuth åº”ç”¨',
    'GitHub Apps': 'GitHub åº”ç”¨',
    'Codespaces': 'Codespaces',
    'Copilot': 'Copilot',
    'Pages': 'Pages',
    'Actions': 'æ“ä½œ',
    'Packages': 'åŒ…',
    'Security log': 'å®‰å…¨æ—¥å¿—',

    // ========== ç»„ç»‡è®¾ç½®èœå• ==========
    'Organization settings': 'ç»„ç»‡è®¾ç½®',
    'Profile': 'èµ„æ–™',
    'People': 'æˆå‘˜',
    'Teams': 'å›¢é˜Ÿ',
    'Billing': 'è´¦å•',
    'SAML SSO': 'SAML SSO',
    'Audit log': 'å®¡è®¡æ—¥å¿—',
    'Actions': 'æ“ä½œ',
    'Packages': 'åŒ…',
    'Secrets and variables': 'å¯†é’¥ä¸å˜é‡',
    'Codespaces': 'Codespaces',
    'Pages': 'Pages',
    'Webhooks': 'Webhooks',
    'OAuth Apps': 'OAuth åº”ç”¨',
    'GitHub Apps': 'GitHub åº”ç”¨',
    'Installed GitHub Apps': 'å·²å®‰è£…çš„ GitHub åº”ç”¨',
    'Custom properties': 'è‡ªå®šä¹‰å±æ€§',
    'Member privileges': 'æˆå‘˜æƒé™',
    'Third-party access': 'ç¬¬ä¸‰æ–¹è®¿é—®',
    'Moderation settings': 'å®¡æ ¸è®¾ç½®',
    'Repository defaults': 'ä»“åº“é»˜è®¤è®¾ç½®',
    'Repository roles': 'ä»“åº“è§’è‰²',
    'Code security': 'ä»£ç å®‰å…¨',
    'Dependabot': 'Dependabot',
    'Code scanning': 'ä»£ç æ‰«æ',
    'Secret scanning': 'å¯†é’¥æ‰«æ',
    'Advanced security': 'é«˜çº§å®‰å…¨',
    'Migration': 'è¿ç§»',
    'Blocked users': 'è¢«å±è”½ç”¨æˆ·',
    'Domain settings': 'åŸŸåè®¾ç½®',
    'Enterprise': 'ä¼ä¸š',

    // ========== é€šçŸ¥ä¸­å¿ƒ ==========
    'Unread': 'æœªè¯»',
    'Participating': 'å‚ä¸çš„',
    'All': 'å…¨éƒ¨',
    'Custom': 'è‡ªå®šä¹‰',
    'Mark all as read': 'å…¨éƒ¨æ ‡è®°ä¸ºå·²è¯»',
    'Mute thread': 'é™éŸ³æ­¤ä¼šè¯',
    'Unmute thread': 'å–æ¶ˆé™éŸ³',
    'Save': 'ä¿å­˜',
    'Saved': 'å·²ä¿å­˜',

    // ========== é‚®ç®±ä¸å¯†é’¥ ==========
    'Email address': 'é‚®ç®±åœ°å€',
    'Primary email address': 'ä¸»é‚®ç®±åœ°å€',
    'Add email address': 'æ·»åŠ é‚®ç®±åœ°å€',
    'Verified': 'å·²éªŒè¯',
    'Unverified': 'æœªéªŒè¯',
    'Set as primary': 'è®¾ä¸ºä¸»é‚®ç®±',
    'Make private': 'è®¾ä¸ºç§æœ‰',
    'Make public': 'è®¾ä¸ºå…¬å¼€',
    'Resend email': 'é‡æ–°å‘é€é‚®ä»¶',
    'Remove': 'ç§»é™¤',

    'SSH keys': 'SSH å¯†é’¥',
    'New SSH key': 'æ–°å»º SSH å¯†é’¥',
    'Title': 'æ ‡é¢˜',
    'Key': 'å¯†é’¥',
    'Add SSH key': 'æ·»åŠ  SSH å¯†é’¥',
    'GPG keys': 'GPG å¯†é’¥',
    'New GPG key': 'æ–°å»º GPG å¯†é’¥',
    'Add GPG key': 'æ·»åŠ  GPG å¯†é’¥',
    'Public key': 'å…¬é’¥',

    // ========== ä»¤ç‰Œ ==========
    'Personal access tokens': 'ä¸ªäººè®¿é—®ä»¤ç‰Œ',
    'Fine-grained tokens': 'ç²¾ç»†ä»¤ç‰Œ',
    'Tokens (classic)': 'ç»å…¸ä»¤ç‰Œ',
    'Generate new token': 'ç”Ÿæˆæ–°ä»¤ç‰Œ',
    'Note': 'å¤‡æ³¨',
    'Expires': 'è¿‡æœŸæ—¶é—´',
    'Token': 'ä»¤ç‰Œ',
    'Configure': 'é…ç½®',
    'Regenerate': 'é‡æ–°ç”Ÿæˆ',
    'Revoke': 'æ’¤é”€',

    // ========== Codespaces ==========
    'Codespaces': 'Codespaces',
    'New codespace': 'æ–°å»º Codespace',
    'Recent codespaces': 'æœ€è¿‘çš„ Codespaces',
    'Dev containers': 'å¼€å‘å®¹å™¨',
    'Settings': 'è®¾ç½®',
    'Preferences': 'åå¥½è®¾ç½®',
    'Features': 'åŠŸèƒ½',
    'Port forwarding': 'ç«¯å£è½¬å‘',
    'Visual Studio Code': 'Visual Studio Code',
    'Browser': 'æµè§ˆå™¨',
    'Start': 'å¯åŠ¨',
    'Stop': 'åœæ­¢',
    'Restart': 'é‡å¯',
    'Export': 'å¯¼å‡º',
    'Delete codespace': 'åˆ é™¤ Codespace',

    // ========== å…¶ä»–é€šç”¨ UI ==========
    'Public': 'å…¬å¼€',
    'Private': 'ç§æœ‰',
    'Internal': 'å†…éƒ¨',
    'Visibility': 'å¯è§æ€§',
    'Description': 'æè¿°',
    'Homepage': 'ä¸»é¡µ',
    'Website': 'ç½‘ç«™',
    'Location': 'ä½ç½®',
    'Company': 'å…¬å¸',
    'Twitter username': 'Twitter ç”¨æˆ·å',
    'Pronouns': 'ä»£è¯',
    'Bio': 'ç®€ä»‹',
    'Update profile': 'æ›´æ–°èµ„æ–™',
    'Change your avatar': 'æ›´æ¢å¤´åƒ',
    'Upload a new photo': 'ä¸Šä¼ æ–°ç…§ç‰‡',
    'Save changes': 'ä¿å­˜æ›´æ”¹',
    'Cancel': 'å–æ¶ˆ',
    'Close': 'å…³é—­',
    'Delete': 'åˆ é™¤',
    'Edit': 'ç¼–è¾‘',
    'Rename': 'é‡å‘½å',
    'Transfer': 'è½¬ç§»',
    'Danger Zone': 'å±é™©åŒºåŸŸ',
    'Permanently delete': 'æ°¸ä¹…åˆ é™¤',
    'Are you sure?': 'ä½ ç¡®å®šå—ï¼Ÿ',
    'Confirm': 'ç¡®è®¤',
    'Search': 'æœç´¢',
    'Filter': 'ç­›é€‰',
    'Sort': 'æ’åº',
    'Loading': 'åŠ è½½ä¸­',
    'No results found': 'æœªæ‰¾åˆ°ç»“æœ',
    'Write': 'æ’°å†™',
    'Preview': 'é¢„è§ˆ',
    'Quote reply': 'å¼•ç”¨å›å¤',
    'React': 'ååº”',
    'View source': 'æŸ¥çœ‹æºç ',
    'Jump to': 'è·³è½¬åˆ°',
    'Quickly navigate files': 'å¿«é€Ÿå¯¼èˆªæ–‡ä»¶',
    'Recent activity': 'æœ€è¿‘æ´»åŠ¨',
    'Popular repositories': 'çƒ­é—¨ä»“åº“',
    'Topics': 'ä¸»é¢˜',
    'Collections': 'åˆé›†',
    'Templates': 'æ¨¡æ¿',
    'Archived': 'å·²å½’æ¡£',
    'Forked from': 'å¤åˆ»è‡ª',
    'Mirror': 'é•œåƒ',
    'Template': 'æ¨¡æ¿ä»“åº“',
    'Sponsor': 'èµåŠ©',
    'Sponsor this project': 'èµåŠ©æ­¤é¡¹ç›®',
    'Back this project': 'æ”¯æŒæ­¤é¡¹ç›®',
    'Learn more': 'äº†è§£æ›´å¤š',
    'Documentation': 'æ–‡æ¡£',
    'API': 'API',
    'Community': 'ç¤¾åŒº',
    'Support': 'æ”¯æŒ',
    'Report abuse': 'ä¸¾æŠ¥æ»¥ç”¨',
    'Contact GitHub': 'è”ç³» GitHub',
    'Status': 'çŠ¶æ€',
    'Training': 'åŸ¹è®­',
    'Blog': 'åšå®¢',
    'About': 'å…³äº',
    'Terms': 'æ¡æ¬¾',
    'Privacy': 'éšç§',
    'Security': 'å®‰å…¨',
    'Team': 'å›¢é˜Ÿ',
    'Enterprise': 'ä¼ä¸šç‰ˆ'
};
    // ğŸ› ï¸ å®‰å…¨æ›¿æ¢æ–‡æœ¬èŠ‚ç‚¹ï¼ˆä¸ç ´å HTML ç»“æ„å’Œå¸ƒå±€ï¼‰
    function replaceTextNodes(node) {
        if (!node || node.nodeType !== Node.ELEMENT_NODE) return;
        // è·³è¿‡ä¸åº”ç¿»è¯‘çš„åŒºåŸŸ
        if (['SCRIPT', 'STYLE', 'TEXTAREA', 'INPUT', 'CODE', 'PRE', 'KBD'].includes(node.tagName)) return;
        if (node.closest?.('code, pre, .js-file-line, .commit-tease, .copy-button, .blob-code')) return;

        for (let i = 0; i < node.childNodes.length; i++) {
            const child = node.childNodes[i];
            if (child.nodeType === Node.TEXT_NODE) {
                const text = child.textContent.trim();
                if (text && TRANSLATION_DICT.hasOwnProperty(text)) {
                    // ä»…æ›¿æ¢åŒ¹é…éƒ¨åˆ†ï¼Œä¿ç•™å‰åç©ºç™½ï¼ˆé¿å…ç ´åå¸ƒå±€ï¼‰
                    child.textContent = child.textContent.replace(text, TRANSLATION_DICT[text]);
                }
            } else if (child.nodeType === Node.ELEMENT_NODE) {
                replaceTextNodes(child);
            }
        }
    }

    // ğŸš€ ç¿»è¯‘å…³é”®åŒºåŸŸ
    function translatePage() {
        const selectors = [
            '#header',                          // é¡¶éƒ¨å¯¼èˆªæ 
            '.Header-item--full',               // ä¸­å¤®èœå•
            '.HeaderMenu',                      // ä¸ªäººä¸‹æ‹‰èœå•å®¹å™¨
            '.UnderlineNav',                    // ä»“åº“é¡µæ ‡ç­¾å¯¼èˆª
            '.dropdown-menu',                   // æ‰€æœ‰ä¸‹æ‹‰èœå•
            '.BorderGrid',                      // è®¾ç½®é¡µé¢ç½‘æ ¼
            '.Box',                             // è®¾ç½®é¡¹å®¹å™¨
            '.menu-item',                       // èœå•é¡¹
            '.js-selected-navigation-item',     // é€‰ä¸­é¡¹
            '.Layout',                          // é€šç”¨å¸ƒå±€å®¹å™¨
            '.application-main'                 // ä¸»å†…å®¹åŒºï¼ˆä¿å®ˆä½¿ç”¨ï¼‰
        ];

        selectors.forEach(selector => {
            document.querySelectorAll(selector).forEach(el => {
                replaceTextNodes(el);
            });
        });
    }

    // ğŸ‘‚ ç›‘å¬åŠ¨æ€å†…å®¹
    const observer = new MutationObserver(() => {
        // é˜²æŠ– + å»¶è¿Ÿç¡®ä¿å…ƒç´ æ¸²æŸ“å®Œæˆ
        clearTimeout(observer.timer);
        observer.timer = setTimeout(translatePage, 200);
    });

    // ğŸš¦ åˆå§‹åŒ–
    function init() {
        translatePage();

        observer.observe(document.body, {
            childList: true,
            subtree: true
        });

        // ç›‘å¬ SPA è·¯ç”±å˜åŒ–
        const originalPushState = history.pushState;
        history.pushState = function (...args) {
            originalPushState.apply(this, args);
            setTimeout(translatePage, 400);
        };
        window.addEventListener('popstate', () => {
            setTimeout(translatePage, 400);
        });
    }

    // ğŸ•’ å¯åŠ¨
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
    } else {
        init();
    }

})();